@using Microsoft.AspNetCore.Identity
@inject UserManager<POE_p2_s4.Models.User> UserManager

@{
    ViewData["Title"] = "Home Page";
    var claims = ViewData["Claims"] as List<Claim>; // Claims data
    var user = ViewData["User"] as POE_p2_s4.Models.User; // User data
    var courses = ViewData["Courses"] as List<POE_p2_s4.Models.Course>; // Courses list
}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>

    @if (user != null)
    {
        if (user.UserType == "Admin")
        {
            <p>Welcome Admin! You have full access to the system.</p>
        }
        else if (user.UserType == "HR")
        {
            <p>Welcome HR! You can manage employee claims and details.</p>
        }
        else if (user.UserType == "Lecturer")
        {
            <p>Welcome Lecturer! Below is your claims history.</p>

            <!-- Claims Table -->
            <table class="table">
                <thead>
                    <tr>
                        <th>Date Submitted</th>
                        <th>Claim Type</th>
                        <th>Claim Status</th>
                    </tr>
                </thead>
                <tbody>
                   
                    @foreach (var claim in claims)
                    {
                        <tr>
                            <td>@claim.ClaimDate</td>
                            <td>@claim.ClaimType</td>
                            <td>@claim.ClaimStatus</td>
                        </tr>
                    }
                </tbody>
            </table>

            <!-- Lecturer Info Block -->
            <div style="display:flex; flex-direction:row; margin-top:20px;">
                <div style="border: 1px solid black; padding: 20px; border-radius: 10px; width: 300px;">
                    <h3>@user.Email</h3>
                    <p>Courses involved:</p>
                    <ul>
                        @foreach (var course in courses)
                        {
                            <li>@course.Name</li>
                        }
                    </ul>
                    <div style="width: 100px; height: 100px; border-radius: 50%; background-color: gray; display: flex; justify-content: center; align-items: center; font-size: 24px;">
                        @user.Email[0]
                    </div>
                </div>

                <!-- Claim Report Summary -->
                <div style="margin-left: 50px;">
                    <h4>Claim Summary</h4>
                    <p>Total Claims: @claims.Count()</p>
                    <p>Approved: @claims.Count(c => c.ClaimStatus == "Approved")</p>
                    <p>Rejected: @claims.Count(c => c.ClaimStatus == "Rejected")</p>
                    <p>Pending: @claims.Count(c => c.ClaimStatus == "Pending")</p>

                    <!-- Loading Bar -->
                    <div style="width: 100%; height: 20px; background-color: #ddd;">
                        <div style="width:@(claims.Count(c => c.ClaimStatus == "Approved") * 100 / claims.Count())%; height:100%; background-color: green;"></div>
                        <div style="width:@(claims.Count(c => c.ClaimStatus == "Rejected") * 100 / claims.Count())%; height:100%; background-color: red;"></div>
                        <div style="width:@(claims.Count(c => c.ClaimStatus == "Pending") * 100 / claims.Count())%; height:100%; background-color: yellow;"></div>
                    </div>
                </div>
            </div>
        }
        else if (user.UserType == "ProgrammeCo_ordinator")
        {
            <p>Welcome Programme Coordinator! Manage course assignments and lecturer coordination.</p>
        }
        else if (user.UserType == "AcademicManager")
        {
            <p>Welcome Academic Manager! Oversee academic programs and lecturer performance.</p>
        }
    }
    else
    {
        <p>Please log in to view your personalized dashboard.</p>
    }
</div>
